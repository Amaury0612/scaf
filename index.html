<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualiseur 3D CBR500R HD</title>
    <style>
        body {
            margin: 0;
            background-color: #050505;
            color: #eee;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        canvas {
            display: block;
        }
        #ui {
            position: absolute;
            top: 20px;
            text-align: center;
            pointer-events: none;
            text-shadow: 0 0 15px rgba(227, 24, 55, 0.5);
        }
        h1 { margin: 0; color: #e31837; text-transform: uppercase; letter-spacing: 3px; font-size: 2em; }
        p { margin: 5px; opacity: 0.8; font-weight: 300; letter-spacing: 1px; }
        .controls {
            position: absolute;
            bottom: 20px;
            background: rgba(0,0,0,0.7);
            padding: 12px 25px;
            border-radius: 30px;
            font-size: 13px;
            border: 1px solid rgba(255,255,255,0.2);
            backdrop-filter: blur(5px);
            display: flex;
            gap: 20px;
            font-family: 'JetBrains Mono', monospace;
        }
        .key-hint { color: #e31837; font-weight: bold; }
    </style>
</head>
<body>

    <div id="ui">
        <h1>Honda CBR500R</h1>
        <p>Modèle Haute Définition (10x Polygons)</p>
    </div>

    <div class="controls">
        <span>SOURIS : Rotation Libre</span>
        <span>TOUCHES : <span class="key-hint">Q</span> / <span class="key-hint">D</span></span>
    </div>

    <!-- Chargement de Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <script>
        let scene, camera, renderer, bikeGroup;
        let isDragging = false;
        let previousMousePosition = { x: 0, y: 0 };
        const keys = { q: false, d: false };

        function init() {
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x050505);

            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 1.5, 4.5);

            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            // Amélioration du rendu des ombres et lumières
            renderer.outputEncoding = THREE.sRGBEncoding;
            document.body.appendChild(renderer.domElement);

            // Lumières améliorées pour le mode HD
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.4);
            scene.add(ambientLight);

            const mainLight = new THREE.DirectionalLight(0xffffff, 1.2);
            mainLight.position.set(10, 10, 10);
            scene.add(mainLight);

            const rimLight = new THREE.PointLight(0xe31837, 1.5, 15);
            rimLight.position.set(-5, 5, -5);
            scene.add(rimLight);

            bikeGroup = new THREE.Group();
            createBike();
            scene.add(bikeGroup);

            // Grille de sol stylisée
            const gridHelper = new THREE.GridHelper(40, 40, 0xe31837, 0x222222);
            gridHelper.position.y = -0.8;
            scene.add(gridHelper);

            // Événements
            window.addEventListener('mousedown', () => isDragging = true);
            window.addEventListener('mouseup', () => isDragging = false);
            window.addEventListener('mousemove', handleRotation);
            window.addEventListener('resize', onWindowResize);
            
            // Contrôles Clavier Q et D
            window.addEventListener('keydown', (e) => {
                if(e.key.toLowerCase() === 'q') keys.q = true;
                if(e.key.toLowerCase() === 'd') keys.d = true;
            });
            window.addEventListener('keyup', (e) => {
                if(e.key.toLowerCase() === 'q') keys.q = false;
                if(e.key.toLowerCase() === 'd') keys.d = false;
            });

            animate();
        }

        function createBike() {
            // Matériaux Premium
            const redMat = new THREE.MeshPhongMaterial({ color: 0xe31837, shininess: 120, specular: 0x222222 });
            const darkMat = new THREE.MeshPhongMaterial({ color: 0x111111, shininess: 30 });
            const chromeMat = new THREE.MeshPhongMaterial({ color: 0xaaaaaa, shininess: 150 });

            // Augmentation radicale des segments (Détail x10)
            const wheelDetail = 160; // au lieu de 16
            const tubeDetail = 64;   // au lieu de 8

            // 1. Roue Arrière (Largeur augmentée)
            const rearWheelGeo = new THREE.TorusGeometry(0.5, 0.18, 40, wheelDetail);
            const rearWheel = new THREE.Mesh(rearWheelGeo, darkMat);
            rearWheel.position.set(-1.2, 0, 0);
            bikeGroup.add(rearWheel);

            // 2. Roue Avant
            const frontWheelGeo = new THREE.TorusGeometry(0.5, 0.14, 40, wheelDetail);
            const frontWheel = new THREE.Mesh(frontWheelGeo, darkMat);
            frontWheel.position.set(1.5, 0, 0);
            bikeGroup.add(frontWheel);

            // 3. Bloc Moteur (Plus complexe)
            const engineGeo = new THREE.BoxGeometry(1.1, 0.7, 0.55);
            const engine = new THREE.Mesh(engineGeo, chromeMat);
            engine.position.set(0.1, 0.1, 0);
            bikeGroup.add(engine);

            // 4. Réservoir CBR (Forme plus fluide)
            const tankGeo = new THREE.BoxGeometry(0.9, 0.6, 0.7, 4, 4, 4);
            const tank = new THREE.Mesh(tankGeo, redMat);
            tank.position.set(0.1, 0.65, 0);
            tank.rotation.z = 0.25;
            bikeGroup.add(tank);

            // 5. Carénage Avant Agressif
            const fairingGeo = new THREE.BoxGeometry(0.9, 0.9, 0.65);
            const fairing = new THREE.Mesh(fairingGeo, redMat);
            fairing.position.set(1.0, 0.75, 0);
            fairing.rotation.z = -0.45;
            bikeGroup.add(fairing);

            // 6. Selle Sport
            const seatGeo = new THREE.BoxGeometry(0.75, 0.15, 0.45);
            const seat = new THREE.Mesh(seatGeo, darkMat);
            seat.position.set(-0.6, 0.65, 0);
            bikeGroup.add(seat);

            // 7. Queue Fine
            const tailGeo = new THREE.BoxGeometry(0.7, 0.25, 0.35);
            const tail = new THREE.Mesh(tailGeo, redMat);
            tail.position.set(-1.15, 0.8, 0);
            tail.rotation.z = 0.35;
            bikeGroup.add(tail);

            // 8. Fourche Inversée (Segments augmentés)
            const forkGeo = new THREE.CylinderGeometry(0.06, 0.06, 1.3, tubeDetail);
            const forkLeft = new THREE.Mesh(forkGeo, chromeMat);
            forkLeft.position.set(1.25, 0.35, 0.18);
            forkLeft.rotation.z = -0.35;
            bikeGroup.add(forkLeft);

            const forkRight = forkLeft.clone();
            forkRight.position.z = -0.18;
            bikeGroup.add(forkRight);

            // 9. Guidon Bracelet
            const barGeo = new THREE.CylinderGeometry(0.04, 0.04, 0.9, tubeDetail);
            const bars = new THREE.Mesh(barGeo, darkMat);
            bars.position.set(1.0, 1.1, 0);
            bars.rotation.x = Math.PI / 2;
            bikeGroup.add(bars);

            // 10. Pot d'échappement Sport
            const exhaustGeo = new THREE.CylinderGeometry(0.12, 0.08, 1.1, tubeDetail);
            const exhaust = new THREE.Mesh(exhaustGeo, chromeMat);
            exhaust.position.set(-0.85, 0.15, 0.35);
            exhaust.rotation.z = 0.55;
            exhaust.rotation.y = 0.25;
            bikeGroup.add(exhaust);
        }

        function handleRotation(e) {
            if (isDragging) {
                const deltaMove = {
                    x: e.clientX - previousMousePosition.x,
                    y: e.clientY - previousMousePosition.y
                };
                const rotationSpeed = 0.007;
                bikeGroup.rotation.y += deltaMove.x * rotationSpeed;
                bikeGroup.rotation.x += deltaMove.y * rotationSpeed;
            }
            previousMousePosition = { x: e.clientX, y: e.clientY };
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function animate() {
            requestAnimationFrame(animate);
            
            const keyRotationSpeed = 0.05;

            // Logique de rotation clavier
            if (keys.q) {
                bikeGroup.rotation.y -= keyRotationSpeed;
            }
            if (keys.d) {
                bikeGroup.rotation.y += keyRotationSpeed;
            }

            // Rotation automatique subtile quand aucune commande n'est active
            if (!isDragging && !keys.q && !keys.d) {
                bikeGroup.rotation.y += 0.003;
            }

            renderer.render(scene, camera);
        }

        window.onload = init;
    </script>
</body>
</html>
