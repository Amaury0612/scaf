<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pong Neo-Classic | GitHub Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=JetBrains+Mono&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon-blue: #00f2ff;
            --neon-pink: #f43f5e;
            --bg-dark: #020617;
        }

        * { box-sizing: border-box; }

        body {
            margin: 0;
            padding: 0;
            background-color: #000;
            color: white;
            font-family: 'Orbitron', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            overflow: hidden;
        }

        #game-container {
            position: relative;
            border: 4px solid var(--neon-blue);
            box-shadow: 0 0 20px var(--primary-dim), inset 0 0 20px rgba(0, 242, 255, 0.2);
            background: var(--bg-dark);
            border-radius: 8px;
        }

        canvas {
            display: block;
            image-rendering: pixelated;
        }

        .ui-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            pointer-events: none;
            width: 100%;
        }

        .score-board {
            position: absolute;
            top: 20px;
            width: 100%;
            display: flex;
            justify-content: space-around;
            font-size: 48px;
            opacity: 0.8;
            pointer-events: none;
        }

        .instructions {
            position: absolute;
            bottom: -60px;
            display: flex;
            justify-content: space-between;
            width: 100%;
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
            color: var(--neon-blue);
            text-transform: uppercase;
        }

        .msg-box {
            background: rgba(0, 0, 0, 0.8);
            padding: 20px 40px;
            border: 2px solid var(--neon-pink);
            border-radius: 10px;
            display: none;
        }

        .active { display: block; }

        h1 { font-size: 24px; margin-bottom: 10px; color: var(--neon-pink); }
        p { font-size: 14px; margin: 5px 0; }
        .blink { animation: blink 1s infinite; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }
    </style>
</head>
<body>

    <div id="game-container">
        <div class="score-board">
            <div id="scoreL">0</div>
            <div id="scoreR">0</div>
        </div>

        <canvas id="pongCanvas"></canvas>

        <div class="ui-overlay" id="startScreen">
            <div class="msg-box active">
                <h1>PONG NEO-CLASSIC</h1>
                <p>JOUEUR 1: [A] HAUT | [Q] BAS</p>
                <p>JOUEUR 2: [P] HAUT | [M] BAS</p>
                <p class="blink" style="margin-top: 20px; color: var(--neon-blue);">APPUYEZ SUR [ESPACE] POUR LANCER</p>
            </div>
        </div>

        <div class="instructions">
            <div>G: A / Q</div>
            <div>D: P / M</div>
        </div>
    </div>

    <script>
        /**
         * CONFIGURATION ET VARIABLES GLOBALES
         */
        const canvas = document.getElementById('pongCanvas');
        const ctx = canvas.getContext('2d');
        const startScreen = document.getElementById('startScreen');
        
        // Tailles fixes pour GitHub Preview mais adaptables
        canvas.width = 800;
        canvas.height = 500;

        const PADDLE_WIDTH = 10;
        const PADDLE_HEIGHT = 80;
        const BALL_SIZE = 8;
        const WINNING_SCORE = 5;

        let gameState = 'START'; // START, PLAY, GAMEOVER
        let scoreL = 0;
        let scoreR = 0;

        // Objets du jeu
        const playerL = { x: 20, y: canvas.height/2 - PADDLE_HEIGHT/2, dy: 0 };
        const playerR = { x: canvas.width - 20 - PADDLE_WIDTH, y: canvas.height/2 - PADDLE_HEIGHT/2, dy: 0 };
        const ball = { x: canvas.width/2, y: canvas.height/2, dx: 4, dy: 4, speed: 5 };

        // Gestion des touches
        const keys = {};

        window.addEventListener('keydown', e => {
            keys[e.key.toLowerCase()] = true;
            if (e.code === 'Space' && (gameState === 'START' || gameState === 'GAMEOVER')) {
                resetGame();
                gameState = 'PLAY';
                startScreen.querySelector('.msg-box').classList.remove('active');
            }
        });
        window.addEventListener('keyup', e => keys[e.key.toLowerCase()] = false);

        /**
         * LOGIQUE DU MOTEUR PHYSIQUE
         */
        function update() {
            if (gameState !== 'PLAY') return;

            // Mouvement Joueur Gauche (A / Q)
            if (keys['a']) playerL.y -= 7;
            if (keys['q']) playerL.y += 7;

            // Mouvement Joueur Droit (P / M)
            if (keys['p']) playerR.y -= 7;
            if (keys['m']) playerR.y += 7;

            // Limites des raquettes
            [playerL, playerR].forEach(p => {
                if (p.y < 0) p.y = 0;
                if (p.y > canvas.height - PADDLE_HEIGHT) p.y = canvas.height - PADDLE_HEIGHT;
            });

            // Mouvement de la balle
            ball.x += ball.dx;
            ball.y += ball.dy;

            // Rebond murs (Haut/Bas)
            if (ball.y <= 0 || ball.y >= canvas.height - BALL_SIZE) {
                ball.dy *= -1;
            }

            // Collision Raquette Gauche
            if (ball.x <= playerL.x + PADDLE_WIDTH && 
                ball.y + BALL_SIZE >= playerL.y && 
                ball.y <= playerL.y + PADDLE_HEIGHT) {
                
                // Calcul de l'angle en fonction de l'endroit où la balle tape la raquette
                let collidePoint = (ball.y + BALL_SIZE/2) - (playerL.y + PADDLE_HEIGHT/2);
                collidePoint = collidePoint / (PADDLE_HEIGHT/2);
                let angleRad = (Math.PI/4) * collidePoint;

                ball.dx = Math.cos(angleRad) * ball.speed;
                ball.dy = Math.sin(angleRad) * ball.speed;
                ball.speed += 0.2; // Accélération progressive
            }

            // Collision Raquette Droite
            if (ball.x + BALL_SIZE >= playerR.x && 
                ball.y + BALL_SIZE >= playerR.y && 
                ball.y <= playerR.y + PADDLE_HEIGHT) {
                
                let collidePoint = (ball.y + BALL_SIZE/2) - (playerR.y + PADDLE_HEIGHT/2);
                collidePoint = collidePoint / (PADDLE_HEIGHT/2);
                let angleRad = (Math.PI/4) * collidePoint;

                ball.dx = -Math.cos(angleRad) * ball.speed;
                ball.dy = Math.sin(angleRad) * ball.speed;
                ball.speed += 0.2;
            }

            // Gestion des scores
            if (ball.x < 0) {
                scoreR++;
                checkWin();
                resetBall(-1);
            } else if (ball.x > canvas.width) {
                scoreL++;
                checkWin();
                resetBall(1);
            }

            document.getElementById('scoreL').innerText = scoreL;
            document.getElementById('scoreR').innerText = scoreR;
        }

        function resetBall(direction) {
            ball.x = canvas.width / 2;
            ball.y = canvas.height / 2;
            ball.speed = 5;
            ball.dx = direction * ball.speed;
            ball.dy = (Math.random() - 0.5) * 6;
        }

        function resetGame() {
            scoreL = 0;
            scoreR = 0;
            resetBall(1);
            playerL.y = canvas.height/2 - PADDLE_HEIGHT/2;
            playerR.y = canvas.height/2 - PADDLE_HEIGHT/2;
        }

        function checkWin() {
            if (scoreL >= WINNING_SCORE || scoreR >= WINNING_SCORE) {
                gameState = 'GAMEOVER';
                const winner = scoreL >= WINNING_SCORE ? "JOUEUR 1" : "JOUEUR 2";
                const msg = startScreen.querySelector('.msg-box');
                msg.querySelector('h1').innerText = `${winner} GAGNE !`;
                msg.classList.add('active');
            }
        }

        /**
         * RENDU GRAPHIQUE
         */
        function draw() {
            // Effacement avec traînée légère
            ctx.fillStyle = 'rgba(2, 6, 23, 0.3)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Ligne centrale
            ctx.setLineDash([10, 15]);
            ctx.beginPath();
            ctx.moveTo(canvas.width / 2, 0);
            ctx.lineTo(canvas.width / 2, canvas.height);
            ctx.strokeStyle = 'rgba(0, 242, 255, 0.2)';
            ctx.lineWidth = 2;
            ctx.stroke();
            ctx.setLineDash([]);

            // Dessin des raquettes (Néon)
            ctx.shadowBlur = 15;
            
            // Joueur Gauche (Bleu)
            ctx.fillStyle = '#00f2ff';
            ctx.shadowColor = '#00f2ff';
            ctx.fillRect(playerL.x, playerL.y, PADDLE_WIDTH, PADDLE_HEIGHT);

            // Joueur Droit (Rose)
            ctx.fillStyle = '#f43f5e';
            ctx.shadowColor = '#f43f5e';
            ctx.fillRect(playerR.x, playerR.y, PADDLE_WIDTH, PADDLE_HEIGHT);

            // Dessin de la balle
            ctx.fillStyle = '#fff';
            ctx.shadowColor = '#fff';
            ctx.shadowBlur = 10;
            ctx.fillRect(ball.x, ball.y, BALL_SIZE, BALL_SIZE);
            
            ctx.shadowBlur = 0; // Reset pour les performances

            requestAnimationFrame(() => {
                update();
                draw();
            });
        }

        // Démarrage de la boucle
        draw();
    </script>
</body>
</html>
